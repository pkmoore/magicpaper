\section{Trick Discussion}
\label{SEC:background}

In this section we discuss the details of each of the tricks we used in our
lesson by first describing the intended pedagogical goal of the trick and then
how the trick works from both the participants' and the magician's
perspectives.  We also include variations for each trick that can improve the
trick's impact or make it easier to perform under certain circumstances.

\section{Social Engineering}

The purpose of this trick is to increase students' awareness of social
engineering by exposing them to a simulated attack in the form of a magic trick.
This is done by engineering the card trick to give the magician multiple
opportunities to ask a student to provide personal information, such as their
full name or place of birth, that may be used for identity theft.
At the end of the trick, the magician reveals that this information collection
was the real purpose of the trick.

\subsection{From the Audience's Perspective}

The magician begins this trick by requesting a student volunteer and stating
that there is a way to form a psychic bond between the student and a deck of
cards.  This is initially achieved by having the student shuffle approximately
half of the cards a few times while the magician shuffles the other half.  Once
this shuffling is complete, the two halves of the deck are combined by placing
one on top of the other.
The magician then asks the student
a few questions to further ``attune'' them to the deck.
First, they are asked for their birth year and their response
is used to select one red card and one black card from the deck
with each with a numeric value equal to one of the last two digits of their
birth year.
Next, the magician asks for the student's birth month and similarly selects
a red card with a numeric value equal
to their birth month (using the jack and queen for November and December
respectively).
Finally, the magician asks the student
for their birth day and select a black card with a numeric value
equal to the second digit in this day.
The magician lays these cards out on the table and asks the student to select
one red card and one black card with which they feel most ``attuned''.
The unchosen cards are returned to the middle
of the deck face up.

At this point, it is time to test the student's psychic powers by asking them to
guess the color of each card in the deck.  Starting with the top of the deck,
the student provides a guess of either ``red'' or ``black.''  The magician
records their guess by placing the card face down on top of the card of the same
color already on the table.  This forms two piles of cards.  When the half way
point of the deck is reached, the two face up cards are placed on top of the
pile of the opposite color.  This switches which pile each guess
will be placed in going forward.  The student continues providing guesses until
there are no cards remaining.  At this point the magician turns over the face
down cards to reveal that the student has correctly guessed {\textbf every}
card's color.

The magician now has an opportunity to further illustrate the student's psychic
link to the deck of cards by using said link to read the student's mind.
First, the cards are collected and the student is asked to
re-shuffle them a few time and cut the deck into two piles.  The magician
selects one of the piles and reveals the bottom card to only the student and the
audience.  This pile is placed on top of the other pile perpendicularly so that
the students card remains accessible.  The magician then asks the student to
make a series of statement pairs with one being true and one being false.  For
example,  the magician may ask the student to state  ``I was born in
\textit{blank},'' with blank being replaced by their birth city, and ``I was
born in Moscow, Russia,'' (assuming the student was \textit{not} born in Moscow,
Russia).  A similar process is used to have the student make true/false
statement pairs about where they attended school earlier in their life, the name
of their childhood best friend, and other similar details about their life.

After the magician has elicited a number of statements sufficient to hone in on
the student's psychic link, a second set of true/false statement pairs are used
to figure out the student's card.  This is done by asking the student to make
statements pairs like ``My card is red'' and ``My card is black.''  Similar
pairs regarding the card's suit and value allow the magician to zero
in on the student's card.

At this point, the trick takes a turn when the magician presents a spreadsheet
to the student and the audience containing their responses to the questions
asked in the course of the trick. This reveals that the trick
was a deception to
collect personal information, generating an opportunity for discussion about what
types of information should can be used in identity theft attempts should they
be made public.


\subsection{Behind the Scenes}

Begin with a deck where the cards have been separated into red and black halves.

\subsection{Variations}

...

\section{Side Channel Attacks}

This trick demonstrates how side channel attacks can allow an attacker to
gather information they shouldn't have been able to access.
The main version of this trick uses a side channel to enable the magician to
find a particular card that has been lost in a shuffled deck with minimal
effort.

\subsection{From the Audience's Perspective}

The magician begins by opening a new deck of cards, removing the jokers and
branding cards, and legitimately shuffling it.  A student is then asked to
select a card from the deck, show it to the audience, and memorize it without
revealing it to the magician.
The magician then presents the deck so that the student may return
the card to it.
The magician then shuffles he deck a few more times ensuring that the card has
been completely lost.
At this point the magician proceeds through the deck face down pick out the
student's card when it appears.

\subsection{Behind the Scenes}

The key to this trick lies in the magician's choice of deck.  Many cheaper card
decks, such as those given away branded merchandise, have corporate logos or
text as part of the art on the card back.  Often, this branding can be used to
provide information about how a card is oriented in the deck.  Because the trick
begins with a fresh deck, all cards are oriented in the same direction.  As a
result, when the student is returning their card to the deck, the magician
simply has to orient the deck in such a way that the students card is returned
in the opposite orientation to the other cards.  During all shuffling
operations the magician may maintain this orientation by rotating one pack of a
cut deck so that it's post-shuffle orientation matches the other pack.
To complete the trick, the magician only has to look through the deck of cards
and find the card with a differing orientation.

\subsection{Variations}

In this trick, the chosen card's orientation is a side channel that conveys
hidden information.  This lesson may be taken further with an additional
exercise where a pre-selected volunteer uses the
pitch or cadence of their voice to signal identifying details of their
card to the magician.  This is done by having the volunteer select a card and
ask the magician questions about its attributes.  For example, a volunteer who
selected a red card may
ask ``Is my card \textit{red} or black?'' varying the pitch of their voice when
they say red as a pre-arranged signal to the magician of he cards true color.
The audience should carefully observe the questioning process in order to
determine what side channel the magician and volunteer are using to
surreptitiously pass information.


\section{Cryptographic Hash Functions}

The purpose of this trick is to generate an opportunity to for instruction on
the details of cryptographic hash functions and expose a potential vulnerability
in their use -- that the last input to the function has an out-sized impact on
the function's output.


\subsection{From the Audience's Perspective}

The trick begins with the magician announcing that they are going to use a
cryptographic hash function to choose a volunteer for the next trick.  The
students in the audience are each asked to provide a random number which will be
fed into the function in order to generate a seat number of one student in the
class.  Using this process a student it selected and is asked to to come
forward.  The magician explains that they have a magic deck of cards that allows
anyone to determine what card is on top of it merely by waving their hand over
it.  The magician shuffles the deck a few times and as the student to pass their
hand over the deck while concentrating.  The student does so and, after a
moment's hesitation, makes a guess.  The magician then shows the top card to the
student and the audience revealing that the student's guess was correct.

\subsection{Behind the Scenes}

This trick relies on two keep components.  The first is the fact that when
multiple inputs are provided to a cryptographic hash function, the last input
has an out-sized impact on the functions output.  The second, is a time-honored
magic show tool known as a ``stooge'' as stooge is an individual in league with
the magician who will pretend to be an involved volunteer in order to make a
trick possible.  In this trick, the stooge uses a piece of software to decide
what ``random'' number to provide during the volunteer selection process in
order to ensure that they are chosen by the magician's hash function.  To do so,
the stooge must enter each number provided by the other students into their
software.  Once chosen, the stooge plays their part in the trick and ``guesses''
a pre-arranged card that the magician has ensured will remain on the top of the
deck during the shuffling process.

\subsection{Variations}

The need to control the top card on the deck may be remove removed by using a
special deck of cards that contains fifty-two copies of the same card.  Such a
deck is readily and cheaply available at a magic supply store.


